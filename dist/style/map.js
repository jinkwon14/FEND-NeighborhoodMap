function ViewModel(){var e=this;e.locationList=ko.observableArray(locations),e.tagList=ko.observableArray(tags),e.filterListBy=ko.observable(),e.filteredList=ko.observableArray(locations),e.filteredList=ko.computed(function(){var t=e.filterListBy();return t?ko.utils.arrayFilter(e.locationList(),function(e){return e.tag===t}):e.locationList()}),e.filterListBy.subscribe(function(){hideListings(),showListings()}),e.currentMarker=ko.observable,showInformation=function(t){e.currentMarker=t.marker,showMarker(e.currentMarker),dropMarker(e.currentMarker),populateInfoWindow(e.currentMarker,t.info),imageSearch(t.titleKo)},e.showListingsMessage=ko.observable(!1),e.hideListingsMessage=ko.observable(!0),showHideListings=function(){this.showListingsMessage(!this.showListingsMessage()),this.hideListingsMessage(!this.hideListingsMessage()),this.showListingsMessage()?hideListings():showListings()},e.showListingsMessage.subscribe(function(){showListings()}),e.hideListingsMessage.subscribe(function(){hideListings()}),islandView=function(){zoomToIslandView()},e.locationImageView=ko.observable(),e.displayImage=ko.observable(1),e.locationImageText=ko.observable("Click to view images."),e.imageIndex=ko.observable(0),e.locationImageView.subscribe(function(){e.displayImage()<3?(e.displayImage(4),e.imageIndex(0),e.locationImage(imageLinkOnly[0].thumbnailUrl),e.locationImageText("Click to hide images.")):(e.displayImage(1),e.locationImageText("Click to view images."))}),e.increaseImageIndex=ko.observable(),e.decreaseImageIndex=ko.observable(),e.locationImage=ko.observable();var t;e.increaseImageIndex=function(){e.imageIndex()<8&&(t=e.imageIndex(),e.imageIndex(t+1)),e.locationImage(imageLinkOnly[e.imageIndex()].thumbnailUrl)},e.decreaseImageIndex=function(){e.imageIndex()>0&&(t=e.imageIndex(),e.imageIndex(t-1)),e.locationImage(imageLinkOnly[e.imageIndex()].thumbnailUrl)},iconMouseOver=function(){this.marker.setIcon(highlightedIcon)},iconMouseOut=function(){this.marker.setIcon(defaultIcon)},e.displayError=ko.observable(-1),e.googleErrorImage=ko.observable(),e.googleErrorDetails=ko.observable(),e.weather=ko.observable(),e.googleWeatherURL=ko.observable(),e.details=ko.observable(),e.weatherErrorMessage=ko.observable()}function initMap(){map=new google.maps.Map(document.getElementById("map"),{center:{lat:33.363385,lng:126.528909},zoom:11,mapTypeControl:!1});var e=new google.maps.InfoWindow({maxWidth:200}),t=locations;vm.currentMarker=new google.maps.Marker,markerList=[];var i;for(i=0;i<t.length;i++){var o=t[i].location,a=t[i].title,n=t[i].description,r=new google.maps.Marker({position:o,description:n,title:a,animation:google.maps.Animation.DROP,icon:defaultIcon,id:i});markerList.push(r),t[i].marker=r,t[i].info=e,r.addListener("click",function(){populateInfoWindow(this,e),dropMarker(this)}),r.addListener("mouseover",function(){this.setIcon(highlightedIcon)}),r.addListener("mouseout",function(){this.setIcon(defaultIcon)}),r.addListener("click",function(){map.setZoom(14),map.setCenter(this.location);var e=this,t=locations.filter(function(t){return t.title==e.title});imageSearch(t[0].titleKo)})}showListings(),ko.applyBindings(vm)}function imageTransition(){setInterval(function(){index=(index+1)%14;var e="img/jeju/jeju"+index+"-min.jpg";vm.googleErrorImage(e)},5e3)}function mapError(){ko.applyBindings(vm),vm.displayError(5),vm.googleErrorDetails("View"),imageTransition()}function populateInfoWindow(e,t){function i(i,o){if(o==google.maps.StreetViewStatus.OK){var a=i.location.latLng,n=google.maps.geometry.spherical.computeHeading(a,e.position);t.setContent("<h4>"+e.title+"</h4><p>"+e.description+'</p><div id="pano"></div>');var r={position:a,pov:{heading:n,pitch:30}};new google.maps.StreetViewPanorama(document.getElementById("pano"),r)}else t.setContent("<h4>"+e.title+"</h4><p>"+e.description+"</p>")}if(t.marker!=e){t.setContent(""),t.marker=e;var o=new google.maps.StreetViewService,a=50;o.getPanoramaByLocation(e.position,a,i),t.open(map,e)}}function showListings(){for(var e=0;e<vm.filteredList().length;e++)vm.filteredList()[e].marker.setMap(map)}function showMarker(e){e.setMap(map)}function hideMarker(e){e.setMap(map)}function zoomToIslandView(){map.setZoom(11),map.setCenter({lat:33.363385,lng:126.528909})}function dropMarker(e){null!==e.getAnimation()?e.setAnimation(null):e.setAnimation(google.maps.Animation.DROP)}function hideListings(){for(var e=0;e<markerList.length;e++)markerList[e].setMap(null)}function makeMarkerIcon(e){var t=new google.maps.MarkerImage("http://chart.googleapis.com/chart?chst=d_map_spin&chld=1.15|0|"+e+"|40|_|%E2%80%A2",new google.maps.Size(21,34),new google.maps.Point(0,0),new google.maps.Point(10,34),new google.maps.Size(21,34));return t}function awxGetCurrentConditions(){currentConditionsUrl="http://apidev.accuweather.com/currentconditions/v1/224209.json?language=en&apikey="+AccuweatherApiId,$.ajax({type:"GET",url:currentConditionsUrl,dataType:"jsonp",cache:!0,jsonpCallback:"awxCallback",success:function(e){var t;if(e&&e.length>0){var i=e[0],o=isMetric?i.Temperature.Metric:i.Temperature.Imperial;condition=i.WeatherText,temperature=o.Value+" "+o.Unit}else t="N/A";vm.weather("Jeju Island is currently "+condition+" and temperature is "+temperature+".")},error:function(){vm.googleWeatherURL("https://www.google.com/webhp?sourceid=chrome-instant&ion=1&espv=2&ie=UTF-8#q=jeju%20weather"),vm.weatherErrorMessage("Click to check current weather in Jeju!")}})}function imageSearch(e){$.ajax({url:"https://api.cognitive.microsoft.com/bing/v5.0/images/search?q="+e+"&12",beforeSend:function(e){e.setRequestHeader("Content-Type","multipart/form-data"),e.setRequestHeader("Ocp-Apim-Subscription-Key",BingApiId)},type:"GET",data:"{body}",success:function(e){imageLinkOnly=e.value},error:function(){imageLinkOnly=[{thumbnailUrl:"img/noImage.jpg"}],vm.locationImageText("No image available :(")}})}for(var locations=[{title:"Home sweet home",titleKo:"아라아이파크",tag:"home",description:"Home far far away.",location:{lat:33.476048,lng:126.550555}},{title:"Nilmori Dong dong",titleKo:"제주 닐모리동동",tag:"cafe",description:"Coffee house with beautiful interior located near the coast. Owned by a big online game company.",location:{lat:33.517761,lng:126.48783}},{title:"Cacadew",titleKo:"제주 카카듀",tag:"cafe",description:"Coffee house that is more well known for its gargantuan tower of shaved ice with matcha icecream.",location:{lat:33.491275,lng:126.541777}},{title:"Dreaming White Donkey",titleKo:"제주 꿈꾸는 흰당나귀",tag:"cafe",description:"A shaved ice place that is considered one of the best in the island.",location:{lat:33.497882,lng:126.529283}},{title:"Lowa",titleKo:"제주 카페 Lowa",tag:"cafe",description:"Coffe house by the coast. Has an open rooftop with glass walls that gives a beautiful view of the coast",location:{lat:33.556064,lng:126.795327}},{title:"Doraji",titleKo:"제주 도라지식당",tag:"restaurant",description:"My personal favorite Korean traditional meal place. Has great seafood dishes.",location:{lat:33.492708,lng:126.505968}},{title:"Roost",titleKo:"루스트",tag:"restaurant",description:"Best happy hour menu. Three dollars gorgonzola pizza and beer!",location:{lat:33.473928,lng:126.545084}},{title:"Oppa Chiken",titleKo:"제주 오븐에 빠진 닭",tag:"restaurant",description:"Fried chicken and beer place.",location:{lat:33.489421,lng:126.533127}},{title:"The Red House",titleKo:"제주 빨간집",tag:"restaurant",description:"Serves everything super spicy including ramen, pork ribs, and chicken wings.",location:{lat:33.498799,lng:126.5309179961237}},{title:"Innisfree",titleKo:"제주 이니스프리하우스 ",tag:"mustgo",description:"A cosmetics shop located on top of a beautiful hill, right next to a big green tea farm.",location:{lat:33.3065761,lng:126.2912568}},{title:"Oh-Sullock",titleKo:"제주 오설록",tag:"mustgo",description:"Green tea place with beautiful building and interior. Also has a cafe that serves greentea roll cakes, tea, icecream, and more.",location:{lat:33.305725,lng:126.289772}},{title:"Top-dong park",titleKo:"제주 탑동 해변광장",tag:"mustgo",description:"Park neat the ocean shore. A place where many local people hang out playing basketball, roller skating, walking by the shore, and others.",location:{lat:33.517753,lng:126.526995}},{title:"Joosang Julli",titleKo:"제주 주상절리",tag:"mustgo",description:"Famous tourism place for its tall hexagonal rock formation.",location:{lat:33.237732,lng:126.425084}},{title:"Marilyn Monroe cafe",titleKo:"제주 우도 마를린 먼로",tag:"cafe",description:"Marilyn Monroe cafe that serves delcious peanut-icecream.",location:{lat:33.5144529,lng:126.957487}},{title:"Halla mountain",titleKo:"한라산",tag:"mustgo",description:"Beautiful volcanic mountain. The moother of volcanic Jeju Island.",location:{lat:33.36091,lng:126.5365854}}],tags=locations.map(function(e){return e.tag}),i;i<locations.length;i++)tags.push(locations[i].tag);var category=jQuery.unique(tags),vm=new ViewModel,defaultIcon="img/marker-blue-min.png",highlightedIcon="img/marker-red-min.png",imageList=[],i;for(i=0;i<13;i++)imageList[i]="img/jeju/jeju"+i+".jpg";var index=0,markerList=[],selectedMarker=[],AccuweatherApiId="hoArfRosT1215",isMetric=!1,currentConditionsUrl;awxGetCurrentConditions();var BingApiId="184159797db94013bdefcc6d2d71692d",searchParam="Russian Blue",bingUrl,imageLinkOnly;imageSearch("Russian Blue");
